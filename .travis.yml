language: ruby
rvm:
  - 2.1.1

install:
  - pip install --user html5validator
  - gem install github-pages html-proofer

before_script:
  - git config user.name "Travis-CI"
  - git config user.email "noreply@travis-ci.org"

script:
  - jekyll build
#  - htmlproof ./_site
#  - html5validator --root ./_site
#  - Dir.chdir("./_site") do
#      #system "rails server &"
#    end
  - git init
  - git add .
  - git commit -m "Deploy to Github Pages"
  - git push --force --quiet "https://${GH_TOKEN}${GH_REF}" master:gh-pages

branches:
  only:
    - Dev

env:
  global:
    - NOKOGIRI_USE_SYSTEM_LIBRARIES=true # speeds up installation of html-proofer
    - secure: "KkDSWYwxb3gfMWPW7eLn1igqVlFJ/m6caFUz3SAdVRWXllLYvkToRvGGkgBRsFXEtGBwjurxXdcgyiING57bBwkoqtP1RkMvUjl3zOubkTN96k5DbLhnJkMiotTDjpU6oTGxMk9T3fQRzPKlOyXHQuXog5BrQnN4vfJXC6H/QUOWV72rAjbqp3nk49bcBRkodbhk2zSjoviJcXCHp9GKB67sfzfFnDAj/knZNVGsVilYdan/4zGWOQvPupOuYG3fInHR3ldYvDx9Uo2AcaToOl69aPzv1kUyK+H+jjlRJBUxaulQSlzskC4aR0Olat74PkzKa4WUbVPfYYGaD4eq3Yaafs2rtXu6E6akmnh2nQYI6dRIvqjQTf262YazTlDwa+y1ihf2pzVfWmdAy1G8J3084tQvYphbQ47TkSy6RhdGfUavQcX1o7stgi7QJ0i++U4sgH7YqTKhV4J6qOx/XWfEfhZBBbD2nXlH93AV/eKg/NbNyk9dO7Yezz146lm8DJF2GUllWFVbHY3aC2jYpF5IHTEWpcM1d1sBuA2tFioWtJvbftGhWWUCJAInLVNDjP5Ntkmey+8aepPAjyXKVUlrc604Ms6xUAkn6p+u39oU/L2n93CIuL5Ru01+1TCuWBpqOENuug3a396jzWSrApGQ7Vmnz3oMNTQU6iTet1E="
    - GH_REF: github.com/PowerShellConferenceEU/dev.git