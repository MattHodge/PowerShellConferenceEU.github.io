language: ruby
rvm:
  - 2.1.1

install:
  #- pip install --user html5validator
  - gem install github-pages html-proofer

before_script:
  - git config user.name "Travis-CI"
  - git config user.email "noreply@travis-ci.org"

script:
  - jekyll build
#  - htmlproof ./_site
#  - html5validator --root ./_site
#  - Dir.chdir("./_site") do
#      #system "rails server &"
#    end
  - git init
  - git add .
  - git commit -m "Deploy to Github Pages"
  - git push --force --quiet "https://${GH_TOKEN}@${GH_REF}" master:gh-pages

branches:
  only:
    - Dev

env:
  global:
    - NOKOGIRI_USE_SYSTEM_LIBRARIES=true # speeds up installation of html-proofer
    - secure: "iCiXp/wqvxU1wBPxaSLhmTCLoynnzpmzjOVO10S2SSbXkbEiJNaDmoLERWbtHNkc2ryYhGLA6r2y9c7VuU0kWg/6HGXtUA2HAoawaR0z4blcMBLVxH9fn24HZv/AOa9TcwBSZ4x65krq4gh0HlDH9gfaNBA+gLun7qrmdCVlf+8AaOYZjqUuM8z5bMXWy1wdj0XzhCkHLn+HR6kH/Jrmh0hv16aBxMlMGJ3CEEa2/iG4bK6a/H8YSoVy3u/npZEL6L6W6FjdeQ499FfoJFwzVfpk3XuIHnH2vAh/oIxqWauKzjZpRW/eJmrXXefnQRatFIVDtdWATygKEldglFzJvhgy93i/nJH1JLFcVzLFfdaP7brcX/dKNOqtg+Fd0c7O+E2LgxMYPTM/N/mogHEu5sRH4cWftfpdCY2BFcLD0xNDPuieDgtIOa7ClE3I2OnT7c7eRgTih1wV8+OkO2Nvk3QEMr3PUdFqAopmbCBVaHt/WZfWDt4pmNimwqtDaogUfcVgtOZdKC58pUzBGBsHi0Hltimc51Uw/diHTJgu9egg3FsXLXRCWf5WoJkoCpd9iVcdhPWO1BStQLWlTfpToJPit1a1PeLTjtUIWtGjNFb+2WF6YkpvIC0yXZlTII87gANB58sa6wiKX/NoKw142VlfZllxr2cGguEwsMBgsDw="
    - GH_REF: github.com/PowerShellConferenceEU/dev.git