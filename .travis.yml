language: ruby
rvm:
  - 2.1.1

install:
  #- pip install --user html5validator
  - gem install github-pages html-proofer

before_script:
  - git config user.name "Travis-CI"
  - git config user.email "noreply@travis-ci.org"

script:
  - jekyll build
#  - htmlproof ./_site
#  - html5validator --root ./_site
#  - Dir.chdir("./_site") do
#      #system "rails server &"
#    end
  - git init
  - git add .
  - git commit -m "Deploy to Github Pages"
  - git push --force --quiet "https://${GH_TOKEN}@${GH_REF}" master:gh-pages

branches:
  only:
    - Dev

env:
  global:
    - NOKOGIRI_USE_SYSTEM_LIBRARIES=true # speeds up installation of html-proofer
    - secure: "FjgvLhkFHOeJU3K1syCK/GZkHfXk3DIO2LAmwsu9oN39M8kc07pwqZQbrdEyU8FAiTawxK92Y4b+/jS8gvcLfUBXVlvrmd/+YWgnCh2cOtL0Vve80p4ceNcByXGobcj6azYPmuVg3xjDVprb7WH9fwZvTpGsHFXh2Rv93HvPfaQBha2TF+f+2c4VZrKY8AOOgjuayUgnxvJC/Wj9ajQYXRnl6AdHsP8Op9kn+JvQ8bdFlSnTTZve3w88Dqn6VQiZa1PSQudRYSsQ9PQYacpcrokxbZXytoJO/2xwSVsI3FQX7fAYzRe1/ZTIC0Ho6u+Lyel8iYdOR/6kCzYeFC7W1XD81Sq1RxfedOwM7pOYbU065afQSx/9GFUMYnW9VDYqTHO/TtNzS23ApJpxCViftdLzQZHl14rhY3NWPWMJSf/xVxtT38ZzPAiUXMMry+154XfYpohLk18mQj1CPVA6s0t0mhwBd/UQs5v/VcCPf9ouimVKUdjjXzqifrkeQhYsXfFVmOpmUe2EDd8VdhPUusfh+fSYPJD0QBQ7xTnZskdwF7oyavAL1zmQxJKMrc6KBffCNaZwxNrTx6mkMMb5RLXrBiA3QFUukzxLtlH9RV7ONnzhLaMYR+vtjVH1yzquDlBa/ZVAObXd0aPQJz97GvRMvDRuE7h5p/LgnSN+YCk="
    - GH_REF: github.com/PowerShellConferenceEU/dev.git